#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ Docker –æ–±—Ä–∞–∑–∞
# –ê–≤—Ç–æ—Ä: dushes

set -e  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ

echo "===== –ù–∞—á–∏–Ω–∞–µ–º –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫ –¥–µ–ø–ª–æ—é ====="

# –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
echo "üîë –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ Docker Hub (docker login)"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ buildx –¥–ª—è –º—É–ª—å—Ç–∏–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–π —Å–±–æ—Ä–∫–∏
echo "===== –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Docker Buildx ====="
docker buildx use cloud-dushes-builder

echo "===== –ù–∞—á–∏–Ω–∞–µ–º –º—É–ª—å—Ç–∏–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—É—é —Å–±–æ—Ä–∫—É –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—é ====="
docker buildx build --platform linux/amd64,linux/arm64 \
  -t dushes/telegram-client:latest \
  --push .

echo "===== –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤ ====="
docker buildx imagetools inspect dushes/telegram-client:latest

echo "‚úÖ –î–µ–ø–ª–æ–π —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!" 